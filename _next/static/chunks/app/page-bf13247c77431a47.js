(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5554:function(e,t,n){Promise.resolve().then(n.bind(n,3423))},3423:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eG}});var a=n(7437),r=n(2265),s=n(8575),l=n(2239),o=n(1455);let c=(0,o.oM)({name:"authentication",initialState:null,reducers:{}}),i=e=>e.authentication.accessToken,d=e=>!!i(e);var u=c.reducer;let h=()=>{let e=(0,l.c)({client_id:"398759449450-vg8cjqnd5om8td4krs398f805k2em8uj.apps.googleusercontent.com",redirect_uri:"https://doehyunbaek.github.io/google-calendar-hours",scope:"https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events.readonly",response_type:"token"});return"https://accounts.google.com/o/oauth2/auth?".concat(e)};var m=()=>((0,r.useEffect)(()=>{window.location.href=h()},[]),null),v=n(1096),p=n.n(v);let g="https://www.googleapis.com/calendar/v3/",y=async e=>{let{url:t,accessToken:n,params:a}=e,r=await fetch("".concat(t,"?").concat((0,l.c)({access_token:n,...a})));return 200!==r.status?(sessionStorage.removeItem("accessToken"),window.location="/",Promise.reject()):r.json()},x=e=>{let{accessToken:t}=e;return y({url:"".concat(g,"users/me/calendarList"),accessToken:t})},_=async e=>{let{accessToken:t,calendarId:n,pageToken:a,acc:r}=e,{items:s,nextPageToken:l}=await y({url:"".concat(g,"calendars/").concat(encodeURIComponent(n),"/events"),accessToken:t,params:{singleEvents:!0,maxResults:2500,pageToken:a,timeMax:p()().add(2,"year").toJSON()}});return l?_({accessToken:t,calendarId:n,pageToken:l,acc:[...r,...s]}):[...r,...s]},w=e=>{let{accessToken:t,calendarId:n}=e;return _({accessToken:t,calendarId:n,acc:[]})};var j=n(2713);n(774);let S=(0,o.oM)({name:"calendarEvents",initialState:{loading:!1,map:{}},reducers:{setCalendarEvents:(e,t)=>{let{payload:n}=t;e.map[n.calendarId]=n.events},setLoading:(e,t)=>{let{payload:n}=t;e.loading=n}}}),{setCalendarEvents:f,setLoading:b}=S.actions,N=e=>{let{calendarId:t}=e;return async(e,n)=>{let a=i(n());try{e(b(!0));let n=await w({accessToken:a,calendarId:t});e(f({calendarId:t,events:n.map(e=>{let{id:t,summary:n,start:a,end:r}=e;return a.dateTime?{id:t,summary:n,start:a.dateTime,end:r.dateTime}:null}).filter(Boolean)}))}catch(e){}finally{e(b(!1))}}},k=e=>{var t,n;return null!==(n=null===(t=e.calendarEvents)||void 0===t?void 0:t.loading)&&void 0!==n&&n},D=(e,t)=>{var n,a;return null!==(a=!k(e)&&(null===(n=e.calendarEvents)||void 0===n?void 0:n.map[t]))&&void 0!==a?a:null};var E=S.reducer;let T=e=>{let t;try{t=JSON.parse(window.localStorage.getItem("config"))}catch(e){}let n={...t,...e};window.localStorage.setItem("config",JSON.stringify(n))},O=()=>{try{return JSON.parse(window.localStorage.getItem("config"))}catch(e){}return null},C={DAY:"day",WEEK:"week",MONTH:"month",YEAR:"year",TOTAL:"total",CUSTOM:"custom"},I="date",M="amount",Y={MONDAY:"monday",SUNDAY:"sunday"};var A=e=>Math.round(100*e)/100;let L=(0,o.oM)({name:"viewState",initialState:null,reducers:{setSelectedCalendarId:(e,t)=>{let{payload:n}=t;e.selectedCalendarId=n},setRangeType:(e,t)=>{let{payload:n}=t;e.selectedRangeType=n},changeRange:(e,t)=>{let{payload:n}=t;"prev"===n?e.currentDatePointerStart=p()(e.currentDatePointerStart).subtract(1,e.selectedRangeType).toJSON():"next"===n&&(e.currentDatePointerStart=p()(e.currentDatePointerStart).add(1,e.selectedRangeType).toJSON())},resetRange:e=>{e.currentDatePointerStart=p()().startOf("day").toJSON()},setWeekStart:(e,t)=>{let{payload:n}=t;e.weekStart=n},setStart:(e,t)=>{let{payload:n}=t;e.currentDatePointerStart=n},setEnd:(e,t)=>{let{payload:n}=t;e.currentDatePointerEnd=n}}}),{changeRange:R,resetRange:J}=L.actions,{setSelectedCalendarId:H,setRangeType:B,setWeekStart:P,setStart:W,setEnd:F}=L.actions,U=e=>e.viewState.selectedCalendarId,Z=e=>e.viewState.currentDatePointerStart,q=e=>e.viewState.selectedRangeType,K=e=>e.viewState.weekStart,V=e=>e.viewState.weekStart===Y.SUNDAY?"en":"de",z=(0,j.P1)([e=>e],e=>{let t,n;let{selectedRangeType:a,currentDatePointerStart:r,currentDatePointerEnd:s}=e.viewState,l=p()(r);return a===C.CUSTOM?{start:p()(r),end:p()(s).add(1,"day")}:(a===C.DAY?n=(t=l.startOf("day")).add(1,"day"):a===C.WEEK?n=(t=l.locale(V(e)).startOf("day").weekday(0)).add(1,"week"):a===C.MONTH?n=(t=l.startOf("month")).add(1,"month"):a===C.YEAR?n=(t=l.startOf("year")).add(1,"year"):a===C.TOTAL&&(t=p()("2000-01-01T10:00:00Z"),n=p()("2040-01-01T10:00:00Z")),{start:t,end:n})}),G=(0,j.P1)([e=>e],e=>{let t=D(e,U(e));if(!t)return null;let{start:n,end:a}=z(e);return t.filter(e=>{let{start:t,end:r}=e;return!(new Date(r)<n||new Date(t)>a)}).map(e=>{let{start:t,end:r,...s}=e;return{...s,start:new Date(t)<n?n.toJSON():t,end:new Date(r)>a?a.toJSON():r}})}),X=e=>{let t=G(e);if(!t)return null;let n=0;return t.forEach(e=>{let{start:t,end:a}=e;n+=(new Date(a)-new Date(t))/1e3/60/60}),A(n)},Q=e=>{var t;return(null===(t=G(e))||void 0===t?void 0:t.length)||0},$=e=>{let{calendarId:t}=e;return(e,n)=>{e(H(t)),T({selectedCalendarId:t}),D(n(),t)||e(N({calendarId:t}))}},ee=e=>{let{range:t}=e;return(e,n)=>{if(t===C.CUSTOM){let{start:t,end:a}=z(n()),r=a.subtract(1,"day");e(W(t.toJSON())),e(F(r.toJSON())),T({start:t.toJSON(),end:r.toJSON()})}e(B(t)),T({selectedRangeType:t})}},et=e=>t=>{t(P(e)),T({weekStart:e})},en=e=>t=>{t(W(e)),T({start:e})},ea=e=>t=>{t(F(e)),T({end:e})};var er=L.reducer;let es=(0,o.oM)({name:"calendars",initialState:{list:null},reducers:{setCalendars:(e,t)=>{let{payload:n}=t;e.list=n}}}),{setCalendars:el}=es.actions,eo=()=>async(e,t)=>{let n=i(t());try{var a;let{items:t}=await x({accessToken:n}),r=t.map(e=>{let{id:t,summary:n}=e;return{id:t,label:n}});e(el(r));let{selectedCalendarId:s}=null!==(a=O())&&void 0!==a?a:{};if(s){let t=null==r?void 0:r.find(e=>{let{id:t}=e;return t===s});e(t?$({calendarId:s}):$({calendarId:null}))}}catch(e){}},ec=e=>e.calendars.list;var ei=es.reducer,ed=()=>{let e=(0,s.I0)(),t=(0,s.v9)(ec),n=(0,s.v9)(U);return(0,a.jsxs)("select",{"data-testid":"CalendarsList",className:"form-select",onChange:t=>{e($({calendarId:t.target.value}))},value:null!=n?n:"",children:[!n&&(0,a.jsx)("option",{children:"Please select calendar"},"default"),t.map(e=>{let{id:t,label:n}=e;return(0,a.jsx)("option",{value:t,children:n},t)})]})},eu=()=>{let e=(0,s.I0)(),t=(0,s.v9)(q);return(0,a.jsxs)("select",{"data-testid":"RangeSelectList",className:"form-select",onChange:t=>e(ee({range:t.target.value})),value:t,children:[(0,a.jsx)("option",{value:"day",children:"Day"}),(0,a.jsx)("option",{value:"week",children:"Week"}),(0,a.jsx)("option",{value:"month",children:"Month"}),(0,a.jsx)("option",{value:"year",children:"Year"}),(0,a.jsx)("option",{value:"total",children:"Total"}),(0,a.jsx)("option",{value:"custom",children:"Custom"})]})},eh=n(6760),em=n.n(eh),ev=()=>{let e=(0,s.I0)();return(0,a.jsxs)("div",{"data-testid":"RangeChanger",className:"btn-group",role:"group",children:[(0,a.jsx)("button",{type:"button",className:em()("btn","btn-outline-secondary"),onClick:()=>e(R("prev")),children:"Prev"}),(0,a.jsx)("button",{type:"button",className:em()("btn","btn-outline-secondary"),onClick:()=>e(J()),children:"Reset"}),(0,a.jsx)("button",{type:"button",className:em()("btn","btn-outline-secondary"),onClick:()=>e(R("next")),children:"Next"})]})},ep=n(5304),eg=n.n(ep),ey=()=>{let e=(0,s.I0)(),{start:t,end:n}=(0,s.v9)(z);return(0,a.jsxs)("div",{className:em()(eg().component,"input-group","input-group-sm"),"data-testid":"CustomRange",children:[(0,a.jsx)("label",{htmlFor:"dateStart",className:"input-group-text",children:"Start:"}),(0,a.jsx)("input",{className:em()("form-control",eg().inputDate),type:"date",id:"dateStart",value:p()(t).format("YYYY-MM-DD"),onChange:t=>{let{target:n}=t;return e(en(p()(n.value).toJSON()))}}),(0,a.jsx)("label",{htmlFor:"dateEnd",className:"input-group-text",children:"End:"}),(0,a.jsx)("input",{className:em()("form-control",eg().inputDate),type:"date",id:"dateEnd",value:p()(n).subtract(1,"day").format("YYYY-MM-DD"),onChange:t=>{let{target:n}=t;return e(ea(p()(n.value).toJSON()))}})]})},ex=n(6664),e_=n.n(ex),ew=()=>(0,a.jsx)("div",{className:e_().hours,children:"".concat((0,s.v9)(X),"h")}),ej=(e,t)=>new Intl.DateTimeFormat([navigator.language,"en-US"],t).format(e),eS=()=>{let e;let t=(0,s.v9)(Z),n=(0,s.v9)(q),r=(0,s.v9)(V),l=p()(t);if(n===C.DAY)e=ej(p()(l),{weekday:"long",day:"numeric",month:"long",year:"numeric"});else if(n===C.WEEK){let t=l.locale(r).weekday(0),n=ej(t,{day:"numeric",month:"numeric",year:"numeric"}),a=ej(t.add(1,"week").subtract(1,"day"),{day:"numeric",month:"numeric",year:"numeric"});e="".concat(n," - ").concat(a)}else n===C.MONTH?e=ej(l,{month:"long",year:"numeric"}):n===C.YEAR&&(e=ej(l,{year:"numeric"}));return(0,a.jsx)("div",{"data-testid":"RangeDisplay",children:e})},ef=n(5524),eb=n.n(ef),eN=e=>{let t=new Blob(["\uFEFF"+e],{type:"text/csv;charset=UTF-8"});return window.URL.createObjectURL(t)},ek=n(1546),eD=n.n(ek);p().extend(eb());let eE=(e,t)=>{let{hours:n}=e,{hours:a}=t;return n>a?-1:n<a?1:0},eT=(e,t)=>{let{start:n}=e,{start:a}=t;return n<a?-1:n>a?1:0},eO=async e=>{try{await navigator.clipboard.writeText(e)}catch(e){}},eC=e=>p()(e).format("DD.MM.YYYY HH:mm");var eI=()=>{var e;let t,n;let[l,o]=(0,r.useState)(I),c=(0,s.v9)(U),i=(0,s.v9)(G),d=(0,s.v9)(ec),u=(0,s.v9)(Z),h=null===(e=d.find(e=>e.id===c))||void 0===e?void 0:e.label,m="dark",v=i.sort(eT).map((e,t,n)=>{var a,r;return p()(e.start).isoWeek()!==((null==n?void 0:null===(a=n[t-1])||void 0===a?void 0:a.start)&&p()(null==n?void 0:null===(r=n[t-1])||void 0===r?void 0:r.start).isoWeek())&&(m="dark"===m?"light":"dark"),{...e,hours:(new Date(e.end)-new Date(e.start))/1e3/60/60,background:m}});return l===M?v=Object.entries(v.reduce((e,t)=>{let{summary:n,hours:a}=t;return e[n]=e[n]?e[n]+=a:a,e},{})).map(e=>{let[t,n]=e;return{summary:t,hours:n,id:t}}).sort(eE):(t=eN(["Start,End,Title,Hours"].concat(v.map(e=>{let{start:t,end:n,summary:a,hours:r}=e;return"".concat(eC(t),",").concat(eC(n),',"').concat(a,'",').concat(A(r))})).join("\n")),n="".concat(h,"_").concat(p()(u).locale("en").format("MMMM_YYYY"),"_(").concat(p()().format("YYYYMMDDHHmmss"),").csv")),(0,a.jsxs)("div",{children:[(0,a.jsx)("ul",{className:eD().list,children:v.map(e=>{let{id:t,start:n,end:r,summary:s,hours:o,background:c}=e;return(0,a.jsxs)("li",{className:em()(eD().listItem,{[eD().listItemLight]:"light"===c,[eD().listItemDark]:"dark"===c}),children:[l===I&&(0,a.jsx)("span",{className:eD().eventDate,title:"".concat(ej(p()(n),{day:"2-digit",month:"2-digit",year:"numeric"}),", ").concat(ej(p()(n),{minute:"2-digit",hour:"2-digit"})," - ").concat(ej(p()(r),{minute:"2-digit",hour:"2-digit"})),children:ej(p()(n),{day:"2-digit",month:"2-digit"})}),(0,a.jsx)("span",{className:eD().eventName,title:s,children:s}),(0,a.jsx)("button",{type:"button",className:eD().copyButton,onClick:()=>eO(s),"aria-label":"Copy",children:(0,a.jsxs)("svg",{className:eD().copyIcon,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,a.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})}),(0,a.jsx)("span",{className:eD().eventHours,children:"".concat(A(o),"h")})]},t)})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:eD().sortByLabel,children:"Sort by:"}),(0,a.jsxs)("div",{className:em()("btn-group","btn-group-sm"),role:"group",children:[(0,a.jsx)("input",{className:"btn-check",type:"radio",value:"date",id:"date",checked:l===I,onChange:e=>{let{target:t}=e;return o(t.value)}}),(0,a.jsx)("label",{className:em()("btn","btn-outline-secondary"),htmlFor:"date",children:"Date"}),(0,a.jsx)("input",{className:"btn-check",type:"radio",value:"amount",id:"amount",checked:l===M,onChange:e=>{let{target:t}=e;return o(t.value)}}),(0,a.jsx)("label",{className:em()("btn","btn-outline-secondary"),htmlFor:"amount",children:"Amount"})]}),t&&(0,a.jsx)("a",{href:t,download:n,className:em()(eD().downloadLink,"btn","btn-outline-secondary","btn-sm"),children:"Export as CSV"})]})]})},eM=n(5021),eY=n.n(eM),eA=()=>{let e=(0,s.I0)(),t=(0,s.v9)(K);return(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:eY().weekStartLabel,children:"Week starts on:"}),(0,a.jsxs)("div",{className:em()("btn-group","btn-group-sm"),role:"group",children:[(0,a.jsx)("input",{className:"btn-check",type:"radio",value:"sunday",id:"sunday",checked:t===Y.SUNDAY,onChange:t=>{let{target:n}=t;return e(et(n.value))}}),(0,a.jsx)("label",{className:em()("btn","btn-outline-secondary"),htmlFor:"sunday",children:"Sunday"}),(0,a.jsx)("input",{className:"btn-check",type:"radio",value:"monday",id:"monday",checked:t===Y.MONDAY,onChange:t=>{let{target:n}=t;return e(et(n.value))}}),(0,a.jsx)("label",{className:em()("btn","btn-outline-secondary"),htmlFor:"monday",children:"Monday"})]})]})},eL=n(1507),eR=n.n(eL),eJ=e=>{let{isEventsOpen:t,setIsEventsOpen:n}=e,r=(0,s.v9)(Q);return(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"button","data-testid":t?"HideEventsButton":"ShowEventsButton",className:em()(eR().showDetailsButton,"btn","btn-outline-secondary","btn-sm"),onClick:()=>n(!t),children:t?"hide details of ".concat(r," events"):"show details of ".concat(r," events")})})},eH=n(8348),eB=n.n(eH),eP=()=>{let e=(0,s.I0)(),[t,n]=(0,r.useState)(!1),l=(0,s.v9)(ec);(0,r.useEffect)(()=>{l||e(eo())});let o=(0,s.v9)(U),c=(0,s.v9)(e=>D(e,o)),i=(0,s.v9)(k),d=(0,s.v9)(q),u=(0,s.v9)(X);return(0,a.jsxs)("div",{className:eB().interface,children:[l?(0,a.jsx)(ed,{}):(0,a.jsx)("div",{children:"loading"}),i&&"loading",c&&(0,a.jsxs)(r.Fragment,{children:[(0,a.jsx)(eu,{}),d!==C.TOTAL&&d!==C.CUSTOM&&(0,a.jsx)(ev,{}),d===C.CUSTOM&&(0,a.jsx)(ey,{}),(0,a.jsx)(ew,{}),d===C.WEEK&&(0,a.jsx)(eA,{}),d!==C.TOTAL&&(0,a.jsx)(eS,{}),!!u&&(0,a.jsx)(eJ,{isEventsOpen:t,setIsEventsOpen:n}),!!u&&t&&(0,a.jsx)(eI,{})]})]})},eW=n(8130),eF=n.n(eW),eU=()=>{let e=(0,s.v9)(d),[t,n]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{var e,t,n;let a=(0,l.J)(null!==(n=null===(t=window.location)||void 0===t?void 0:null===(e=t.hash)||void 0===e?void 0:e.slice(1))&&void 0!==n?n:"");a.access_token&&(sessionStorage.setItem("accessToken",a.access_token),window.location="/")},[]),(0,r.useEffect)(()=>{n(!0)},[]),(0,a.jsx)("div",{className:eF().appWrapper,children:(0,a.jsx)("div",{className:eF().app,children:(0,a.jsxs)("div",{className:eF().sticky,children:[(0,a.jsxs)("div",{className:eF().content,children:[(0,a.jsx)("h1",{className:eF().headline,children:"Google Calendar Hours Calculator"}),(!t||!e)&&(0,a.jsx)(m,{}),t&&e&&(0,a.jsx)(eP,{})]}),(0,a.jsx)("footer",{className:eF().footer,children:(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{children:"\xa9 2011 - 2025. This app is open source. "}),(0,a.jsx)("a",{href:"https://github.com/aronwoost/google-calendar-hours",target:"_blank",rel:"noreferrer",children:"Check it on GitHub"}),(0,a.jsx)("span",{children:"."})]})})]})})})},eZ=n(7292),eq=n.n(eZ);p().extend(eq());let eK=()=>{try{return sessionStorage.getItem("accessToken")}catch(e){}return null},eV=()=>{var e,t,n;let a=null!==(e=O())&&void 0!==e?e:{};return{selectedRangeType:null!==(t=a.selectedRangeType)&&void 0!==t?t:C.MONTH,currentDatePointerStart:a.selectedRangeType===C.CUSTOM?a.start:p()().startOf("day").toJSON(),currentDatePointerEnd:a.end,weekStart:null!==(n=a.weekStart)&&void 0!==n?n:Y.MONDAY}};var ez=()=>(0,o.xC)({reducer:{authentication:u,calendars:ei,viewState:er,calendarEvents:E},preloadedState:{authentication:{accessToken:eK()},viewState:eV()}});function eG(){return(0,a.jsx)(s.zt,{store:ez(),children:(0,a.jsx)(eU,{})})}n(6278),n(3282)},3282:function(){},8130:function(e){e.exports={appWrapper:"App_appWrapper__4ujfq",app:"App_app___XJFW",sticky:"App_sticky__jFcSd",content:"App_content__N51C7",headline:"App_headline__q2cYV",footer:"App_footer__H44bm"}},8348:function(e){e.exports={interface:"Interface_interface__U3bJY"}},5304:function(e){e.exports={component:"CustomRange_component__JTYTq",inputDate:"CustomRange_inputDate__K4yXZ"}},1546:function(e){e.exports={list:"Events_list__2CQgB",listItem:"Events_listItem__tesqm",listItemDark:"Events_listItemDark__BJsyA",listItemLight:"Events_listItemLight__23Kx7",eventDate:"Events_eventDate__7peIM",eventName:"Events_eventName__HsZcZ",copyButton:"Events_copyButton__wTk3T",copyIcon:"Events_copyIcon__3N2B_",eventHours:"Events_eventHours__MqwGH",sortByLabel:"Events_sortByLabel__B3F3n",downloadLink:"Events_downloadLink__LW6Qr"}},6664:function(e){e.exports={hours:"Hours_hours__bZzAy"}},1507:function(e){e.exports={showDetailsButton:"ShowDetailsButton_showDetailsButton__cXVZk"}},5021:function(e){e.exports={weekStartLabel:"WeekStart_weekStartLabel__z4_jD"}}},function(e){e.O(0,[735,231,667,907,971,117,744],function(){return e(e.s=5554)}),_N_E=e.O()}]);